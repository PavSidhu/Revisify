(function(a){a.selectator=function(c,e){var n={prefix:"selectator_",height:"auto",useDimmer:false,useSearch:true,showAllOptionsOnFocus:false,selectFirstOptionOnSearch:true,keepOpen:false,searchCallback:function(){},labels:{search:"Search..."}};var f=this;f.settings={};var b=a(c);var t=null;var q=null;var s=null;var w=null;var o=null;var p=b.attr("multiple")===undefined;var k=!p;var r=true;var x={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,capslock:20,escape:27,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40};f.init=function(){f.settings=a.extend({},n,e);if(f.settings.useDimmer){if(a("#"+f.settings.prefix+"dimmer").length===0){var y=a(document.createElement("div"));y.attr("id",f.settings.prefix+"dimmer");y.hide();a(document.body).prepend(y)}}b.addClass("selectator");t=a(document.createElement("div"));if(b.attr("id")!==undefined){t.attr("id",f.settings.prefix+b.attr("id"))}t.addClass(f.settings.prefix+"element "+(k?"multiple ":"single ")+"options-hidden");if(!f.settings.useSearch){t.addClass("disable_search")}t.css({width:b.css("width"),minHeight:b.css("height"),padding:b.css("padding"),"flex-grow":b.css("flex-grow"),position:"relative"});if(f.settings.height==="element"){t.css({height:b.outerHeight()+"px"})}w=a(document.createElement("span"));w.addClass(f.settings.prefix+"textlength");w.css({position:"absolute",visibility:"hidden"});t.append(w);q=a(document.createElement("div"));q.addClass(f.settings.prefix+"chosen_items");t.append(q);s=a(document.createElement("input"));s.addClass(f.settings.prefix+"input");s.attr("tabindex",b.attr("tabindex"));if(!f.settings.useSearch){s.attr("readonly",true);s.css({width:"0px",height:"0px",overflow:"hidden",border:0,padding:0,position:"absolute"})}else{if(p){s.attr("placeholder",f.settings.labels.search)}else{s.width(20)}}s.attr("autocomplete","false");t.append(s);o=a(document.createElement("ul"));o.addClass(f.settings.prefix+"options");t.append(o);b.after(t);b.hide();if(typeof Scrollator!=="undefined"){o.scrollator({zIndex:1001,customClass:"ease_preventOverlay"})}b.change(function(){l()});t.on("focus",function(z){s.focus();s.trigger("focus")});t.on("mousedown",function(A){A.preventDefault();s.focus();s.trigger("focus");if(s[0].setSelectionRange){s[0].setSelectionRange(s.val().length,s.val().length)}else{if(s[0].createTextRange){var z=s[0].createTextRange();z.collapse(true);z.moveEnd("character",s.val().length);z.moveStart("character",s.val().length);z.select()}}});t.on("mouseup",function(z){});t.on("click",function(z){s.focus();s.trigger("focus")});t.on("dblclick",function(z){s.select();s.trigger("focus")});s.on("click",function(z){});s.on("dblclick",function(z){});s.on("keydown",function(C){var B=C.keyCode||C.which;var z=null;var A=null;switch(B){case x.up:C.preventDefault();d();z=o.find(".active");if(z.length!==0){A=z.prevUntil("."+f.settings.prefix+"option:visible").add(z).first().prev("."+f.settings.prefix+"option:visible");z.removeClass("active");A.addClass("active")}else{o.find("."+f.settings.prefix+"option").filter(":visible").last().addClass("active")}i();break;case x.down:C.preventDefault();d();z=o.find(".active");if(z.length!==0){A=z.nextUntil("."+f.settings.prefix+"option:visible").add(z).last().next("."+f.settings.prefix+"option:visible");z.removeClass("active");A.addClass("active")}else{o.find("."+f.settings.prefix+"option").filter(":visible").first().addClass("active")}i();break;case x.escape:C.preventDefault();break;case x.enter:C.preventDefault();z=o.find(".active");if(z.length!==0){v()}else{if(s.val()!==""){f.settings.searchCallback(s.val())}}j();break;case x.backspace:if(f.settings.useSearch){if(s.val()===""&&k){b.find("option:selected").last()[0].selected=false;b.trigger("change");l()}j()}else{C.preventDefault()}break;default:j();break}});s.on("keyup",function(A){A.preventDefault();A.stopPropagation();var z=A.which;switch(z){case x.escape:h();break;case x.enter:if(!f.settings.keepOpen){h()}break;case x.left:case x.right:case x.up:case x.down:case x.tab:case x.shift:break;default:m();break}if(t.hasClass("options-hidden")&&(z===x.left||z===x.right||z===x.up||z===x.down)){d()}j()});s.on("focus",function(z){t.addClass("focused");if(p||f.settings.showAllOptionsOnFocus||!f.settings.useSearch){d()}});s.on("blur",function(z){t.removeClass("focused");h()});t.delegate("."+f.settings.prefix+"option","mouseover",function(B){var z=o.find(".active");z.removeClass("active");var A=a(this);A.addClass("active")});t.delegate("."+f.settings.prefix+"option","mousedown",function(z){z.preventDefault();z.stopPropagation()});t.delegate("."+f.settings.prefix+"option","mouseup",function(z){v()});t.delegate("."+f.settings.prefix+"option","click",function(z){z.stopPropagation()});u();l()};var j=function(){w.text(s.val());if(k){var y=w.width()>(t.width()-30)?(t.width()-30):(w.width()+30);s.css({width:y+"px"})}};var l=function(){q.empty();b.find("option").each(function(){var E=a(this);if(this.selected){var y=a(document.createElement("div"));y.addClass(f.settings.prefix+"chosen_item");y.addClass(f.settings.prefix+"value_"+E.val().replace(/\W/g,""));if(E.attr("class")!==undefined){y.addClass(E.attr("class"))}if(E.data("left")!==undefined){var A=a(document.createElement("div"));A.addClass(f.settings.prefix+"chosen_item_left").html(E.attr("data-left"));y.append(A)}if(E.data("right")!==undefined){var z=a(document.createElement("div"));z.addClass(f.settings.prefix+"chosen_item_right").html(E.attr("data-right"));y.append(z)}var D=a(document.createElement("div"));D.addClass(f.settings.prefix+"chosen_item_title").html(E.html());y.append(D);if(E.data("subtitle")!==undefined){var C=a(document.createElement("div"));C.addClass(f.settings.prefix+"chosen_item_subtitle").html(E.attr("data-subtitle"));y.append(C)}var B=a(document.createElement("div"));B.data("source_option_element",this);B.addClass(f.settings.prefix+"chosen_item_remove");B.on("mousedown",function(F){});B.on("mouseup",function(F){a(this).data("source_option_element").selected=false;b.trigger("change");m();l()});B.html("X");y.append(B);q.append(y)}})};var u=function(){o.empty();var y=[];b.children().each(function(){if(a(this).prop("tagName").toLowerCase()==="optgroup"){var z=a(this);if(z.children("option").length!==0){var A=[];z.children("option").each(function(){A.push({type:"option",text:a(this).html(),element:this})});y.push({type:"group",text:z.attr("label"),options:A,element:z})}}else{y.push({type:"option",text:a(this).html(),element:this})}});a(y).each(function(){if(this.type==="group"){var A=a(document.createElement("li"));A.addClass(f.settings.prefix+"group");if(a(this.element).attr("class")!==undefined){A.addClass(a(this.element).attr("class"))}A.html(a(this.element).attr("label"));o.append(A);a(this.options).each(function(){var B=g.call(this.element,true);o.append(B)})}else{var z=g.call(this.element,false);o.append(z)}});m()};var g=function(z){var D=a(document.createElement("li"));D.data("source_option_element",this);D.addClass(f.settings.prefix+"option");D.addClass(f.settings.prefix+"value_"+a(this).val().replace(/\W/g,""));if(z){D.addClass(f.settings.prefix+"group_option")}if(this.selected){D.addClass("active")}if(a(this).attr("class")!==undefined){D.addClass(a(this).attr("class"))}if(a(this).data("left")!==undefined){var A=a(document.createElement("div"));A.addClass(f.settings.prefix+"option_left").html(a(this).attr("data-left"));D.append(A)}if(a(this).data("right")!==undefined){var y=a(document.createElement("div"));y.addClass(f.settings.prefix+"option_right").html(a(this).attr("data-right"));D.append(y)}var C=a(document.createElement("div"));C.addClass(f.settings.prefix+"option_title").html(a(this).html());D.append(C);if(a(this).data("subtitle")!==undefined){var B=a(document.createElement("div"));B.addClass(f.settings.prefix+"option_subtitle").html(a(this).attr("data-subtitle"));D.append(B)}return D};var m=function(){var z=s.val().replace(/\s/g,"")==="";r=false;var y=s.val().toLowerCase();o.find("."+f.settings.prefix+"option").each(function(){var B=a(this);var A=B.data("source_option_element");if((!A.selected||p)&&(f.settings.useSearch&&(z||a(A).html().toLowerCase().indexOf(y)!==-1)||!f.settings.useSearch)){B.show();r=!r?true:r}else{B.hide()}});o.find("."+f.settings.prefix+"group").each(function(){var B=a(this);var A=false;B.nextUntil("."+f.settings.prefix+"group").each(function(){var C=a(this);if(C.css("display")!="none"){A=true;return false}});if(A){B.show()}else{B.hide()}});d();if(k){o.find(".active").removeClass("active");if(!z){o.find("."+f.settings.prefix+"option").filter(":visible").first().addClass("active")}}};var d=function(){if(s.is(":focus")&&(r||p)){t.removeClass("options-hidden").addClass("options-visible");if(f.settings.useDimmer){a("#"+f.settings.prefix+"dimmer").show()}setTimeout(function(){o.css("top",(t.outerHeight()+(k?0:s.outerHeight())-1)+"px");if(typeof Scrollator!=="undefined"){o.data("scrollator").show()}},1);i()}else{h()}};var h=function(){t.removeClass("options-visible").addClass("options-hidden");if(typeof Scrollator!=="undefined"){o.data("scrollator").hide()}if(f.settings.useDimmer){a("#"+f.settings.prefix+"dimmer").hide()}};var i=function(){var y=o.find("."+f.settings.prefix+"option.active");if(y.length>0){o.scrollTop(o.scrollTop()+y.position().top-o.height()/2+y.height()/2)}};var v=function(){var y=o.find(".active");y.data("source_option_element").selected=true;b.trigger("change");s.val("");m();l();if(!f.settings.keepOpen){h()}};f.refresh=function(){l()};f.destroy=function(){t.remove();a.removeData(c,"selectator");b.show();if(a("."+f.settings.prefix+"element").length===0){a("#"+f.settings.prefix+"dimmer").remove()}};f.init()};a.fn.selectator=function(b){b=b!==undefined?b:{};return this.each(function(){if(typeof(b)==="object"){if(undefined===a(this).data("selectator")){var c=new a.selectator(this,b);a(this).data("selectator",c)}}else{if(a(this).data("selectator")[b]){a(this).data("selectator")[b].apply(this,Array.prototype.slice.call(arguments,1))}else{a.error("Method "+b+" does not exist in $.selectator")}}})}}(jQuery));$(function(){$(".selectator").each(function(){var b=$(this);var a={};$.each(b.data(),function(c,d){if(c.substring(0,10)=="selectator"){a[c.substring(10,11).toLowerCase()+c.substring(11)]=d}});b.selectator(a)})});